<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mi Proyecto Firebase</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container shadow">
    <h1>Registro y Inicio de Sesión</h1>

    <!-- Formulario de Registro -->
    <form id="registerForm">
      <input type="email" id="email" placeholder="Correo Electrónico" required>
      <input type="password" id="password" placeholder="Contraseña" required>
      <button type="submit">Registrar</button>
    </form>

    <!-- Formulario de Inicio de Sesión -->
    <form id="loginForm">
      <input type="email" id="loginEmail" placeholder="Correo Electrónico" required>
      <input type="password" id="loginPassword" placeholder="Contraseña" required>
      <button type="submit">Iniciar Sesión</button>
    </form>
  </div>

  <!-- Agrega los scripts de Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.x.y/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.x.y/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.x.y/firebase-database.js"></script>

  <!-- Inicializa Firebase y Funciones -->
  <script>
    // Tu configuración de Firebase
    const firebaseConfig = {
      apiKey: "TU_API_KEY",
      authDomain: "TU_AUTH_DOMAIN",
      databaseURL: "https://base-de-datos-web-ffd19-default-rtdb.firebaseio.com",
      projectId: "TU_PROJECT_ID",
      storageBucket: "TU_STORAGE_BUCKET",
      messagingSenderId: "TU_MESSAGING_SENDER_ID",
      appId: "TU_APP_ID"
    };

    // Inicializa Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const database = firebase.database();

    // Función para Registrar Usuarios
    document.getElementById('registerForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      auth.createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
          const user = userCredential.user;
          // Guarda el usuario en la base de datos
          firebase.database().ref('users/' + user.uid).set({
            email: user.email,
            uid: user.uid
          });
          console.log("Usuario registrado y guardado en la base de datos.");
        })
        .catch((error) => {
          console.error("Error al registrar el usuario:", error);
        });
    });

    // Función para Iniciar Sesión y Verificar Usuarios
    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;

      auth.signInWithEmailAndPassword(email, password)
        .then((userCredential) => {
          const user = userCredential.user;
          // Recupera los datos del usuario desde la base de datos
          firebase.database().ref('users/' + user.uid).once('value')
            .then((snapshot) => {
              if (snapshot.exists()) {
                console.log("Usuario verificado:", snapshot.val());
              } else {
                console.log("No se encontraron datos del usuario.");
              }
            })
            .catch((error) => {
              console.error("Error al verificar el usuario:", error);
            });
        })
        .catch((error) => {
          console.error("Error al iniciar sesión:", error);
        });
    });
  </script>
</body>
</html>
